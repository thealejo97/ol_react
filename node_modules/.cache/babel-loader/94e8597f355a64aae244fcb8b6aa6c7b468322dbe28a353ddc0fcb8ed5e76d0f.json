{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\usuario\\\\Documents\\\\proyectos\\\\OL_React\\\\ol_react\\\\src\\\\pages\\\\HomePage\\\\HomePageContainer.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport HomePageView from \"./HomePageView\";\nimport httpService from \"../../services/httpService\";\nimport { API_ENDPOINTS } from \"../../services/config\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst HomePageContainer = () => {\n  _s();\n  const [merchants, setMerchants] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [itemsPerPage, setItemsPerPage] = useState(10);\n  const navigate = useNavigate(); // Hook para navegar entre rutas\n\n  useEffect(() => {\n    const fetchMerchants = async () => {\n      setLoading(true);\n      try {\n        const data = await httpService(`${API_ENDPOINTS.MERCHANTS}?page=${currentPage - 1}&size=${itemsPerPage}`);\n        setMerchants(data.content);\n        setTotalPages(data.totalPages);\n      } catch (err) {\n        setError(\"Error al cargar los comerciantes.\");\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchMerchants();\n  }, [currentPage, itemsPerPage]);\n  const handlePageChange = page => {\n    setCurrentPage(page);\n  };\n  const handleDownloadCSV = async () => {\n    try {\n      const jwtToken = localStorage.getItem(\"jwtToken\");\n      const response = await fetch(`${API_ENDPOINTS.MERCHANTS_EXCEL}`, {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${jwtToken}` // Incluye el token si es necesario\n        }\n      });\n      if (!response.ok) {\n        throw new Error(\"No se pudo descargar el archivo CSV\");\n      }\n      const blob = await response.blob(); // Convierte la respuesta en un archivo\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement(\"a\");\n      link.href = url;\n      link.setAttribute(\"download\", \"reporte_comerciantes.csv\");\n      document.body.appendChild(link);\n      link.click();\n      link.remove();\n    } catch (err) {\n      console.error(\"Error al descargar el archivo CSV:\", err.message);\n      alert(\"Ocurrió un error al intentar descargar el archivo CSV.\");\n    }\n  };\n  const handleItemsPerPageChange = newItemsPerPage => {\n    setItemsPerPage(newItemsPerPage);\n    setCurrentPage(1);\n  };\n  const handleLogout = () => {\n    localStorage.removeItem(\"jwtToken\");\n    window.location.href = \"/login\";\n  };\n  const handleCreateNewForm = () => {\n    navigate(\"/merchant-form\"); // Navegar a la página de formulario\n  };\n  return /*#__PURE__*/_jsxDEV(HomePageView, {\n    merchants: merchants,\n    loading: loading,\n    error: error,\n    onLogout: handleLogout,\n    currentPage: currentPage,\n    totalPages: totalPages,\n    onPageChange: handlePageChange,\n    itemsPerPage: itemsPerPage,\n    onItemsPerPageChange: handleItemsPerPageChange,\n    onCreateNewForm: handleCreateNewForm,\n    onDownloadCSV: handleDownloadCSV // Aquí está pasando correctamente\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n};\n_s(HomePageContainer, \"WFFq8td8ybBs31eSDkuw1nHi/4M=\", false, function () {\n  return [useNavigate];\n});\n_c = HomePageContainer;\nexport default HomePageContainer;\nvar _c;\n$RefreshReg$(_c, \"HomePageContainer\");","map":{"version":3,"names":["React","useEffect","useState","HomePageView","httpService","API_ENDPOINTS","useNavigate","jsxDEV","_jsxDEV","HomePageContainer","_s","merchants","setMerchants","loading","setLoading","error","setError","currentPage","setCurrentPage","totalPages","setTotalPages","itemsPerPage","setItemsPerPage","navigate","fetchMerchants","data","MERCHANTS","content","err","handlePageChange","page","handleDownloadCSV","jwtToken","localStorage","getItem","response","fetch","MERCHANTS_EXCEL","method","headers","Authorization","ok","Error","blob","url","window","URL","createObjectURL","link","document","createElement","href","setAttribute","body","appendChild","click","remove","console","message","alert","handleItemsPerPageChange","newItemsPerPage","handleLogout","removeItem","location","handleCreateNewForm","onLogout","onPageChange","onItemsPerPageChange","onCreateNewForm","onDownloadCSV","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/usuario/Documents/proyectos/OL_React/ol_react/src/pages/HomePage/HomePageContainer.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport HomePageView from \"./HomePageView\";\r\nimport httpService from \"../../services/httpService\"; \r\nimport { API_ENDPOINTS } from \"../../services/config\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst HomePageContainer = () => {\r\n  const [merchants, setMerchants] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [totalPages, setTotalPages] = useState(1);\r\n  const [itemsPerPage, setItemsPerPage] = useState(10);\r\n\r\n  const navigate = useNavigate(); // Hook para navegar entre rutas\r\n\r\n  useEffect(() => {\r\n    const fetchMerchants = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const data = await httpService(\r\n          `${API_ENDPOINTS.MERCHANTS}?page=${currentPage - 1}&size=${itemsPerPage}`\r\n        );\r\n        setMerchants(data.content);\r\n        setTotalPages(data.totalPages);\r\n      } catch (err) {\r\n        setError(\"Error al cargar los comerciantes.\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchMerchants();\r\n  }, [currentPage, itemsPerPage]);\r\n\r\n  const handlePageChange = (page) => {\r\n    setCurrentPage(page);\r\n  };\r\n\r\n\r\n  const handleDownloadCSV = async () => {\r\n    try {\r\n      const jwtToken = localStorage.getItem(\"jwtToken\");\r\n      const response = await fetch(`${API_ENDPOINTS.MERCHANTS_EXCEL}`, {\r\n        method: \"GET\",\r\n        headers: {\r\n          Authorization: `Bearer ${jwtToken}`, // Incluye el token si es necesario\r\n        },\r\n      });\r\n  \r\n      if (!response.ok) {\r\n        throw new Error(\"No se pudo descargar el archivo CSV\");\r\n      }\r\n  \r\n      const blob = await response.blob(); // Convierte la respuesta en un archivo\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement(\"a\");\r\n      link.href = url;\r\n      link.setAttribute(\"download\", \"reporte_comerciantes.csv\");\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      link.remove();\r\n    } catch (err) {\r\n      console.error(\"Error al descargar el archivo CSV:\", err.message);\r\n      alert(\"Ocurrió un error al intentar descargar el archivo CSV.\");\r\n    }\r\n  };\r\n  \r\n\r\n  \r\n  const handleItemsPerPageChange = (newItemsPerPage) => {\r\n    setItemsPerPage(newItemsPerPage);\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"jwtToken\");\r\n    window.location.href = \"/login\";\r\n  };\r\n\r\n  const handleCreateNewForm = () => {\r\n    navigate(\"/merchant-form\"); // Navegar a la página de formulario\r\n  };\r\n\r\n  return (\r\n    <HomePageView\r\n      merchants={merchants}\r\n      loading={loading}\r\n      error={error}\r\n      onLogout={handleLogout}\r\n      currentPage={currentPage}\r\n      totalPages={totalPages}\r\n      onPageChange={handlePageChange}\r\n      itemsPerPage={itemsPerPage}\r\n      onItemsPerPageChange={handleItemsPerPageChange}\r\n      onCreateNewForm={handleCreateNewForm}\r\n      onDownloadCSV={handleDownloadCSV} // Aquí está pasando correctamente\r\n    />\r\n\r\n  );\r\n};\r\n\r\nexport default HomePageContainer;\r\n\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}